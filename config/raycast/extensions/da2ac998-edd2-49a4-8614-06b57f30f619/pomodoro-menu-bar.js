"use strict";var m=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var $=Object.prototype.hasOwnProperty;var w=(t,e)=>{for(var r in e)m(t,r,{get:e[r],enumerable:!0})},J=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let u of _(e))!$.call(t,u)&&u!==r&&m(t,u,{get:()=>e[u],enumerable:!(s=M(e,u))||s.enumerable});return t};var H=t=>J(m({},"__esModule",{value:!0}),t);var Y={};w(Y,{default:()=>F});module.exports=H(Y);var o=require("@raycast/api"),D=require("react");var I="Focus",v="Short Break",g="Long Break";var a=require("@raycast/api");var i=new a.Cache,l="pomodoro-interval/1.1",h="pomodoro-interval/completed-pomodoro-count",y="pomodoro-interval/history",f=()=>Math.round(new Date().valueOf()/1e3);async function U(){let t=await a.LocalStorage.getItem(y);return typeof t!="string"||t===null?[]:JSON.parse(t)}async function C(t){let e=await U(),r=e.findIndex(s=>s.id===t.id);r!==-1?e[r]=t:e.push(t),await a.LocalStorage.setItem(y,JSON.stringify(e))}function x({parts:t}){return t.reduce((e,r)=>(typeof r.pausedAt<"u"?r.pausedAt-r.startedAt:f()-r.startedAt)+e,0)}function k(t){return x(t)/t.length*100}function b({parts:t}){return!!t[t.length-1].pausedAt}function S(t,e){let r=0;e||(r=parseInt(i.get(h)??"0",10),r++),i.set(h,r.toString());let s={type:t,id:r,length:V[t],parts:[{startedAt:f()}]};return i.set(l,JSON.stringify(s)),C(s).then(),s}function O(){let t=p();if(t){let e=[...t.parts];e[e.length-1].pausedAt=f(),t={...t,parts:e},i.set(l,JSON.stringify(t))}return t}function A(){let t=p();if(t){let e=[...t.parts,{startedAt:f()}];t={...t,parts:e},i.set(l,JSON.stringify(t))}return t}function B(){i.remove(l)}function p(){let t=i.get(l);if(t)return JSON.parse(t)}function E(t){try{t.parts[t.parts.length-1].endAt=f(),C(t).then(),(0,a.launchCommand)({name:"pomodoro-control-timer",type:a.LaunchType.UserInitiated,context:{currentInterval:t}})}catch(e){console.error(e)}}var c=(0,a.getPreferenceValues)(),V={focus:parseInt(c.focusIntervalDuration)*60,"short-break":parseInt(c.shortBreakIntervalDuration)*60,"long-break":parseInt(c.longBreakIntervalDuration)*60};function P(t){if(t<=0)return"00:00";let e=Math.floor(t/60),r=t%60;return`${e<10?`0${e}`:e}:${r<10?`0${r}`:r}`}var n=require("react/jsx-runtime"),N={light:"#000000",dark:"#FFFFFF",adjustContrast:!1};function F(){let[t,e]=(0,D.useState)(p());t&&k(t)>=100&&E(t);function r(T){e(S(T))}function s(){e(O())}function u(){e(A())}function L(){B(),e(void 0)}let d;d={source:"tomato-0.png",tintColor:N},t&&(d={source:`tomato-${100-Math.floor(k(t)/10)*10}.png`,tintColor:N});let R=c.enableTimeOnMenuBar?t?P(t.length-x(t)):"--:--":void 0;return(0,n.jsx)(o.MenuBarExtra,{icon:d,title:R,tooltip:"Pomodoro",children:t?(0,n.jsxs)(n.Fragment,{children:[b(t)?(0,n.jsx)(o.MenuBarExtra.Item,{title:"Continue",icon:o.Icon.Play,onAction:u,shortcut:{modifiers:["cmd"],key:"c"}}):(0,n.jsx)(o.MenuBarExtra.Item,{title:"Pause",icon:o.Icon.Pause,onAction:s,shortcut:{modifiers:["cmd"],key:"p"}}),(0,n.jsx)(o.MenuBarExtra.Item,{title:"Reset",icon:o.Icon.Stop,onAction:L,shortcut:{modifiers:["cmd"],key:"r"}})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.MenuBarExtra.Item,{title:I,subtitle:`${c.focusIntervalDuration}:00`,icon:"\u{1F3AF}",onAction:()=>r("focus"),shortcut:{modifiers:["cmd"],key:"f"}}),(0,n.jsx)(o.MenuBarExtra.Item,{title:v,subtitle:`${c.shortBreakIntervalDuration}:00`,icon:"\u{1F9D8}\u200D\u2642\uFE0F",onAction:()=>r("short-break"),shortcut:{modifiers:["cmd"],key:"s"}}),(0,n.jsx)(o.MenuBarExtra.Item,{title:g,subtitle:`${c.longBreakIntervalDuration}:00`,icon:"\u{1F6B6}",onAction:()=>r("long-break"),shortcut:{modifiers:["cmd"],key:"l"}})]})})}
