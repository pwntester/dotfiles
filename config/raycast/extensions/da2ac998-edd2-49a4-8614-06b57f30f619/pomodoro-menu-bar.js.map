{
  "version": 3,
  "sources": ["../src/pomodoro-menu-bar.tsx", "../lib/constants.ts", "../lib/intervals.tsx", "../lib/secondsToTime.tsx"],
  "sourcesContent": ["import { MenuBarExtra, Icon, Image, Color } from \"@raycast/api\";\nimport { useState } from \"react\";\nimport { FocusText, LongBreakText, ShortBreakText } from \"../lib/constants\";\nimport {\n  createInterval,\n  getCurrentInterval,\n  resetInterval,\n  pauseInterval,\n  continueInterval,\n  isPaused,\n  duration,\n  preferences,\n  progress,\n  endOfInterval,\n} from \"../lib/intervals\";\nimport { secondsToTime } from \"../lib/secondsToTime\";\nimport { Interval, IntervalType } from \"../lib/types\";\n\nconst IconTint: Color.Dynamic = {\n  light: \"#000000\",\n  dark: \"#FFFFFF\",\n  adjustContrast: false,\n};\n\nexport default function TogglePomodoroTimer() {\n  const [currentInterval, setCurrentInterval] = useState<Interval | undefined>(getCurrentInterval());\n\n  if (currentInterval && progress(currentInterval) >= 100) {\n    endOfInterval(currentInterval);\n  }\n\n  function onStart(type: IntervalType) {\n    setCurrentInterval(createInterval(type));\n  }\n\n  function onPause() {\n    setCurrentInterval(pauseInterval());\n  }\n\n  function onContinue() {\n    setCurrentInterval(continueInterval());\n  }\n\n  function onReset() {\n    resetInterval();\n    setCurrentInterval(undefined);\n  }\n\n  let icon: Image.ImageLike;\n  icon = { source: \"tomato-0.png\", tintColor: IconTint };\n  if (currentInterval) {\n    const progressInTenth = 100 - Math.floor(progress(currentInterval) / 10) * 10;\n    icon = { source: `tomato-${progressInTenth}.png`, tintColor: IconTint };\n  }\n\n  const title = preferences.enableTimeOnMenuBar\n    ? currentInterval\n      ? secondsToTime(currentInterval.length - duration(currentInterval))\n      : \"--:--\"\n    : undefined;\n\n  return (\n    <MenuBarExtra icon={icon} title={title} tooltip={\"Pomodoro\"}>\n      {currentInterval ? (\n        <>\n          {isPaused(currentInterval) ? (\n            <MenuBarExtra.Item\n              title=\"Continue\"\n              icon={Icon.Play}\n              onAction={onContinue}\n              shortcut={{ modifiers: [\"cmd\"], key: \"c\" }}\n            />\n          ) : (\n            <MenuBarExtra.Item\n              title=\"Pause\"\n              icon={Icon.Pause}\n              onAction={onPause}\n              shortcut={{ modifiers: [\"cmd\"], key: \"p\" }}\n            />\n          )}\n          <MenuBarExtra.Item\n            title=\"Reset\"\n            icon={Icon.Stop}\n            onAction={onReset}\n            shortcut={{ modifiers: [\"cmd\"], key: \"r\" }}\n          />\n        </>\n      ) : (\n        <>\n          <MenuBarExtra.Item\n            title={FocusText}\n            subtitle={`${preferences.focusIntervalDuration}:00`}\n            icon={`\uD83C\uDFAF`}\n            onAction={() => onStart(\"focus\")}\n            shortcut={{ modifiers: [\"cmd\"], key: \"f\" }}\n          />\n          <MenuBarExtra.Item\n            title={ShortBreakText}\n            subtitle={`${preferences.shortBreakIntervalDuration}:00`}\n            icon={`\uD83E\uDDD8\u200D\u2642\uFE0F`}\n            onAction={() => onStart(\"short-break\")}\n            shortcut={{ modifiers: [\"cmd\"], key: \"s\" }}\n          />\n          <MenuBarExtra.Item\n            title={LongBreakText}\n            subtitle={`${preferences.longBreakIntervalDuration}:00`}\n            icon={`\uD83D\uDEB6`}\n            onAction={() => onStart(\"long-break\")}\n            shortcut={{ modifiers: [\"cmd\"], key: \"l\" }}\n          />\n        </>\n      )}\n    </MenuBarExtra>\n  );\n}\n", "export const FocusText = 'Focus'\nexport const ShortBreakText = 'Short Break'\nexport const LongBreakText = 'Long Break'", "import { Cache, getPreferenceValues, launchCommand, LaunchType, LocalStorage } from \"@raycast/api\";\nimport { FocusText, LongBreakText, ShortBreakText } from \"./constants\";\nimport { Interval, IntervalExecutor, IntervalType } from \"./types\";\n\nconst cache = new Cache();\n\nconst CURRENT_INTERVAL_CACHE_KEY = \"pomodoro-interval/1.1\";\nconst COMPLETED_POMODORO_COUNT_CACHE_KEY = \"pomodoro-interval/completed-pomodoro-count\";\nconst POMODORO_INTERVAL_HISTORY = \"pomodoro-interval/history\";\n\nconst currentTimestamp = () => Math.round(new Date().valueOf() / 1000);\n\nexport async function getIntervalHistory(): Promise<Interval[]> {\n  const history = await LocalStorage.getItem(POMODORO_INTERVAL_HISTORY);\n\n  if (typeof history !== \"string\" || history === null) {\n    return [];\n  }\n  const intervales = JSON.parse(history);\n  return intervales;\n}\n\nexport async function saveIntervalHistory(interval: Interval) {\n  const history = await getIntervalHistory();\n  const index = history.findIndex((i) => i.id === interval.id);\n\n  if (index !== -1) {\n    history[index] = interval;\n  } else {\n    history.push(interval);\n  }\n\n  await LocalStorage.setItem(POMODORO_INTERVAL_HISTORY, JSON.stringify(history));\n}\n\nexport function duration({ parts }: Interval): number {\n  return parts.reduce((acc, part) => {\n    return (\n      (typeof part.pausedAt !== \"undefined\" ? part.pausedAt - part.startedAt : currentTimestamp() - part.startedAt) +\n      acc\n    );\n  }, 0);\n}\n\nexport function progress(interval: Interval): number {\n  return (duration(interval) / interval.length) * 100;\n}\n\nexport function isPaused({ parts }: Interval): boolean {\n  return !!parts[parts.length - 1].pausedAt;\n}\n\nexport function createInterval(type: IntervalType, isFreshStart?: boolean): Interval {\n  let completedCount = 0;\n  if (isFreshStart) {\n    cache.set(COMPLETED_POMODORO_COUNT_CACHE_KEY, completedCount.toString());\n  } else {\n    completedCount = parseInt(cache.get(COMPLETED_POMODORO_COUNT_CACHE_KEY) ?? \"0\", 10);\n    completedCount++;\n    cache.set(COMPLETED_POMODORO_COUNT_CACHE_KEY, completedCount.toString());\n  }\n  const interval: Interval = {\n    type,\n    id: completedCount,\n    length: intervalDurations[type],\n    parts: [\n      {\n        startedAt: currentTimestamp(),\n      },\n    ],\n  };\n  cache.set(CURRENT_INTERVAL_CACHE_KEY, JSON.stringify(interval));\n  saveIntervalHistory(interval).then();\n  return interval;\n}\n\nexport function pauseInterval(): Interval | undefined {\n  let interval = getCurrentInterval();\n  if (interval) {\n    const parts = [...interval.parts];\n    parts[parts.length - 1].pausedAt = currentTimestamp();\n    interval = {\n      ...interval,\n      parts,\n    };\n    cache.set(CURRENT_INTERVAL_CACHE_KEY, JSON.stringify(interval));\n  }\n  return interval;\n}\n\nexport function continueInterval(): Interval | undefined {\n  let interval = getCurrentInterval();\n  if (interval) {\n    const parts = [...interval.parts, { startedAt: currentTimestamp() }];\n    interval = {\n      ...interval,\n      parts,\n    };\n    cache.set(CURRENT_INTERVAL_CACHE_KEY, JSON.stringify(interval));\n  }\n  return interval;\n}\n\nexport function resetInterval() {\n  cache.remove(CURRENT_INTERVAL_CACHE_KEY);\n}\n\nexport function getCurrentInterval(): Interval | undefined {\n  const result = cache.get(CURRENT_INTERVAL_CACHE_KEY);\n  if (result) {\n    return JSON.parse(result);\n  }\n}\n\nexport function endOfInterval(currentInterval: Interval) {\n  try {\n    currentInterval.parts[currentInterval.parts.length - 1].endAt = currentTimestamp();\n    saveIntervalHistory(currentInterval).then();\n    launchCommand({\n      name: \"pomodoro-control-timer\",\n      type: LaunchType.UserInitiated,\n      context: { currentInterval },\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nexport function getCompletedPomodoroCount(): number {\n  const result = cache.get(COMPLETED_POMODORO_COUNT_CACHE_KEY);\n  if (result) {\n    return parseInt(result, 10);\n  }\n\n  return 0;\n}\n\nexport function getNextIntervalExecutor(): IntervalExecutor {\n  const currentInterval = getCurrentInterval();\n  resetInterval();\n\n  const completedCount = getCompletedPomodoroCount();\n  const longBreakThreshold = parseInt(preferences.longBreakStartThreshold, 10);\n  let executor: IntervalExecutor | undefined;\n  switch (currentInterval?.type) {\n    case \"short-break\":\n      executor = { title: FocusText, onStart: () => createInterval(\"focus\", false) };\n      break;\n    case \"long-break\":\n      executor = { title: FocusText, onStart: () => createInterval(\"focus\") };\n      break;\n    default:\n      if (completedCount === longBreakThreshold) {\n        executor = {\n          title: LongBreakText,\n          onStart: () => createInterval(\"long-break\"),\n        };\n      } else {\n        executor = {\n          title: ShortBreakText,\n          onStart: () => createInterval(\"short-break\", false),\n        };\n      }\n      break;\n  }\n\n  return executor;\n}\n\nexport const preferences = getPreferenceValues<Preferences>();\nexport const intervalDurations: Record<IntervalType, number> = {\n  focus: parseInt(preferences.focusIntervalDuration) * 60,\n  \"short-break\": parseInt(preferences.shortBreakIntervalDuration) * 60,\n  \"long-break\": parseInt(preferences.longBreakIntervalDuration) * 60,\n};\n", "export function secondsToTime(secondsToDisplay: number): string {\n  if (secondsToDisplay <= 0) {\n    return \"00:00\";\n  }\n  const minutes = Math.floor(secondsToDisplay / 60);\n  const seconds = secondsToDisplay % 60;\n  return `${minutes < 10 ? `0${minutes}` : minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAiD,wBACjDC,EAAyB,iBCDlB,IAAMC,EAAY,QACZC,EAAiB,cACjBC,EAAgB,aCF7B,IAAAC,EAAoF,wBAIpF,IAAMC,EAAQ,IAAI,QAEZC,EAA6B,wBAC7BC,EAAqC,6CACrCC,EAA4B,4BAE5BC,EAAmB,IAAM,KAAK,MAAM,IAAI,KAAK,EAAE,QAAQ,EAAI,GAAI,EAErE,eAAsBC,GAA0C,CAC9D,IAAMC,EAAU,MAAM,eAAa,QAAQH,CAAyB,EAEpE,OAAI,OAAOG,GAAY,UAAYA,IAAY,KACtC,CAAC,EAES,KAAK,MAAMA,CAAO,CAEvC,CAEA,eAAsBC,EAAoBC,EAAoB,CAC5D,IAAMF,EAAU,MAAMD,EAAmB,EACnCI,EAAQH,EAAQ,UAAWI,GAAMA,EAAE,KAAOF,EAAS,EAAE,EAEvDC,IAAU,GACZH,EAAQG,CAAK,EAAID,EAEjBF,EAAQ,KAAKE,CAAQ,EAGvB,MAAM,eAAa,QAAQL,EAA2B,KAAK,UAAUG,CAAO,CAAC,CAC/E,CAEO,SAASK,EAAS,CAAE,MAAAC,CAAM,EAAqB,CACpD,OAAOA,EAAM,OAAO,CAACC,EAAKC,KAErB,OAAOA,EAAK,SAAa,IAAcA,EAAK,SAAWA,EAAK,UAAYV,EAAiB,EAAIU,EAAK,WACnGD,EAED,CAAC,CACN,CAEO,SAASE,EAASP,EAA4B,CACnD,OAAQG,EAASH,CAAQ,EAAIA,EAAS,OAAU,GAClD,CAEO,SAASQ,EAAS,CAAE,MAAAJ,CAAM,EAAsB,CACrD,MAAO,CAAC,CAACA,EAAMA,EAAM,OAAS,CAAC,EAAE,QACnC,CAEO,SAASK,EAAeC,EAAoBC,EAAkC,CACnF,IAAIC,EAAiB,EACjBD,IAGFC,EAAiB,SAASpB,EAAM,IAAIE,CAAkC,GAAK,IAAK,EAAE,EAClFkB,KACApB,EAAM,IAAIE,EAAoCkB,EAAe,SAAS,CAAC,EAEzE,IAAMZ,EAAqB,CACzB,KAAAU,EACA,GAAIE,EACJ,OAAQC,EAAkBH,CAAI,EAC9B,MAAO,CACL,CACE,UAAWd,EAAiB,CAC9B,CACF,CACF,EACA,OAAAJ,EAAM,IAAIC,EAA4B,KAAK,UAAUO,CAAQ,CAAC,EAC9DD,EAAoBC,CAAQ,EAAE,KAAK,EAC5BA,CACT,CAEO,SAASc,GAAsC,CACpD,IAAId,EAAWe,EAAmB,EAClC,GAAIf,EAAU,CACZ,IAAMI,EAAQ,CAAC,GAAGJ,EAAS,KAAK,EAChCI,EAAMA,EAAM,OAAS,CAAC,EAAE,SAAWR,EAAiB,EACpDI,EAAW,CACT,GAAGA,EACH,MAAAI,CACF,EACAZ,EAAM,IAAIC,EAA4B,KAAK,UAAUO,CAAQ,CAAC,CAChE,CACA,OAAOA,CACT,CAEO,SAASgB,GAAyC,CACvD,IAAIhB,EAAWe,EAAmB,EAClC,GAAIf,EAAU,CACZ,IAAMI,EAAQ,CAAC,GAAGJ,EAAS,MAAO,CAAE,UAAWJ,EAAiB,CAAE,CAAC,EACnEI,EAAW,CACT,GAAGA,EACH,MAAAI,CACF,EACAZ,EAAM,IAAIC,EAA4B,KAAK,UAAUO,CAAQ,CAAC,CAChE,CACA,OAAOA,CACT,CAEO,SAASiB,GAAgB,CAC9BzB,EAAM,OAAOC,CAA0B,CACzC,CAEO,SAASsB,GAA2C,CACzD,IAAMG,EAAS1B,EAAM,IAAIC,CAA0B,EACnD,GAAIyB,EACF,OAAO,KAAK,MAAMA,CAAM,CAE5B,CAEO,SAASC,EAAcC,EAA2B,CACvD,GAAI,CACFA,EAAgB,MAAMA,EAAgB,MAAM,OAAS,CAAC,EAAE,MAAQxB,EAAiB,EACjFG,EAAoBqB,CAAe,EAAE,KAAK,KAC1C,iBAAc,CACZ,KAAM,yBACN,KAAM,aAAW,cACjB,QAAS,CAAE,gBAAAA,CAAgB,CAC7B,CAAC,CACH,OAASC,EAAO,CACd,QAAQ,MAAMA,CAAK,CACrB,CACF,CA2CO,IAAMC,KAAc,uBAAiC,EAC/CC,EAAkD,CAC7D,MAAO,SAASD,EAAY,qBAAqB,EAAI,GACrD,cAAe,SAASA,EAAY,0BAA0B,EAAI,GAClE,aAAc,SAASA,EAAY,yBAAyB,EAAI,EAClE,EC9KO,SAASE,EAAcC,EAAkC,CAC9D,GAAIA,GAAoB,EACtB,MAAO,QAET,IAAMC,EAAU,KAAK,MAAMD,EAAmB,EAAE,EAC1CE,EAAUF,EAAmB,GACnC,MAAO,GAAGC,EAAU,GAAK,IAAIA,CAAO,GAAKA,CAAO,IAAIC,EAAU,GAAK,IAAIA,CAAO,GAAKA,CAAO,EAC5F,CHyDQ,IAAAC,EAAA,6BA9CFC,EAA0B,CAC9B,MAAO,UACP,KAAM,UACN,eAAgB,EAClB,EAEe,SAARC,GAAuC,CAC5C,GAAM,CAACC,EAAiBC,CAAkB,KAAI,YAA+BC,EAAmB,CAAC,EAE7FF,GAAmBG,EAASH,CAAe,GAAK,KAClDI,EAAcJ,CAAe,EAG/B,SAASK,EAAQC,EAAoB,CACnCL,EAAmBM,EAAeD,CAAI,CAAC,CACzC,CAEA,SAASE,GAAU,CACjBP,EAAmBQ,EAAc,CAAC,CACpC,CAEA,SAASC,GAAa,CACpBT,EAAmBU,EAAiB,CAAC,CACvC,CAEA,SAASC,GAAU,CACjBC,EAAc,EACdZ,EAAmB,MAAS,CAC9B,CAEA,IAAIa,EACJA,EAAO,CAAE,OAAQ,eAAgB,UAAWhB,CAAS,EACjDE,IAEFc,EAAO,CAAE,OAAQ,UADO,IAAM,KAAK,MAAMX,EAASH,CAAe,EAAI,EAAE,EAAI,EACjC,OAAQ,UAAWF,CAAS,GAGxE,IAAMiB,EAAQC,EAAY,oBACtBhB,EACEiB,EAAcjB,EAAgB,OAASkB,EAASlB,CAAe,CAAC,EAChE,QACF,OAEJ,SACE,OAAC,gBAAa,KAAMc,EAAM,MAAOC,EAAO,QAAS,WAC9C,SAAAf,KACC,oBACG,UAAAmB,EAASnB,CAAe,KACvB,OAAC,eAAa,KAAb,CACC,MAAM,WACN,KAAM,OAAK,KACX,SAAUU,EACV,SAAU,CAAE,UAAW,CAAC,KAAK,EAAG,IAAK,GAAI,EAC3C,KAEA,OAAC,eAAa,KAAb,CACC,MAAM,QACN,KAAM,OAAK,MACX,SAAUF,EACV,SAAU,CAAE,UAAW,CAAC,KAAK,EAAG,IAAK,GAAI,EAC3C,KAEF,OAAC,eAAa,KAAb,CACC,MAAM,QACN,KAAM,OAAK,KACX,SAAUI,EACV,SAAU,CAAE,UAAW,CAAC,KAAK,EAAG,IAAK,GAAI,EAC3C,GACF,KAEA,oBACE,oBAAC,eAAa,KAAb,CACC,MAAOQ,EACP,SAAU,GAAGJ,EAAY,qBAAqB,MAC9C,KAAM,YACN,SAAU,IAAMX,EAAQ,OAAO,EAC/B,SAAU,CAAE,UAAW,CAAC,KAAK,EAAG,IAAK,GAAI,EAC3C,KACA,OAAC,eAAa,KAAb,CACC,MAAOgB,EACP,SAAU,GAAGL,EAAY,0BAA0B,MACnD,KAAM,8BACN,SAAU,IAAMX,EAAQ,aAAa,EACrC,SAAU,CAAE,UAAW,CAAC,KAAK,EAAG,IAAK,GAAI,EAC3C,KACA,OAAC,eAAa,KAAb,CACC,MAAOiB,EACP,SAAU,GAAGN,EAAY,yBAAyB,MAClD,KAAM,YACN,SAAU,IAAMX,EAAQ,YAAY,EACpC,SAAU,CAAE,UAAW,CAAC,KAAK,EAAG,IAAK,GAAI,EAC3C,GACF,EAEJ,CAEJ",
  "names": ["pomodoro_menu_bar_exports", "__export", "TogglePomodoroTimer", "__toCommonJS", "import_api", "import_react", "FocusText", "ShortBreakText", "LongBreakText", "import_api", "cache", "CURRENT_INTERVAL_CACHE_KEY", "COMPLETED_POMODORO_COUNT_CACHE_KEY", "POMODORO_INTERVAL_HISTORY", "currentTimestamp", "getIntervalHistory", "history", "saveIntervalHistory", "interval", "index", "i", "duration", "parts", "acc", "part", "progress", "isPaused", "createInterval", "type", "isFreshStart", "completedCount", "intervalDurations", "pauseInterval", "getCurrentInterval", "continueInterval", "resetInterval", "result", "endOfInterval", "currentInterval", "error", "preferences", "intervalDurations", "secondsToTime", "secondsToDisplay", "minutes", "seconds", "import_jsx_runtime", "IconTint", "TogglePomodoroTimer", "currentInterval", "setCurrentInterval", "getCurrentInterval", "progress", "endOfInterval", "onStart", "type", "createInterval", "onPause", "pauseInterval", "onContinue", "continueInterval", "onReset", "resetInterval", "icon", "title", "preferences", "secondsToTime", "duration", "isPaused", "FocusText", "ShortBreakText", "LongBreakText"]
}
